<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Xin lỗi người yêu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background: radial-gradient(circle at 15% 20%, #fae1f7 0%, #c1f7fa 80%) center, #f9d6e7;
      min-height: 100vh;
      margin: 0;
      font-family: 'Nunito', 'Segoe UI', Arial, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    body::before {
      content: '';
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none;
      z-index: 0;
      background:
        repeating-radial-gradient(circle, #ffe3f7 0px, #ffe3f7 1.5px, transparent 2.5px, transparent 30px),
        repeating-radial-gradient(circle, #b8f4ff 0px, #b8f4ff 1.5px, transparent 2.5px, transparent 40px);
      opacity: 0.23;
    }

    .music-btn {
      position: absolute;
      top: 20px;
      right: 28px;
      z-index: 2;
      background: linear-gradient(90deg, #ffb7d9 0%, #b8f4ff 100%);
      border: none;
      border-radius: 50%;
      width: 46px;
      height: 46px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.6rem;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 2px 10px rgba(225, 77, 162, 0.10);
      transition: background 0.3s, transform 0.15s, box-shadow 0.2s;
      outline: none;
      border: 2px solid #ffe3f7;
    }
    .music-btn.active {
      background: linear-gradient(90deg, #ff93c2 0%, #57c2e7 100%);
      color: #e52b50;
      transform: scale(1.15);
      box-shadow: 0 6px 18px rgba(225, 77, 162, 0.14);
    }
    .music-btn:active {
      transform: scale(1);
      box-shadow: 0 2px 10px rgba(225, 77, 162, 0.10);
    }

    .chat-container {
      position: relative;
      z-index: 1;
      background: rgba(255,255,255,0.98);
      border-radius: 32px;
      box-shadow: 0 6px 32px 0 rgba(225, 77, 162, 0.18), 0 0px 0px 8px #ffe3f7 inset;
      padding: 40px 28px 32px 28px;
      width: 100%;
      max-width: 410px;
      text-align: center;
      animation: floatUp 1.2s;
    }
    @keyframes floatUp {
      from {transform: translateY(40px); opacity: 0;}
      to {transform: translateY(0); opacity: 1;}
    }

    .sticker {
      font-size: 2.7rem;
      margin-bottom: 8px;
      animation: stickerPop 1.1s;
    }
    @keyframes stickerPop {
      0% {transform: scale(0);}
      60% {transform: scale(1.4);}
      100% {transform: scale(1);}
    }
    .question {
      font-size: 1.22rem;
      font-weight: 600;
      margin-bottom: 26px;
      min-height: 54px;
      color: #ff44a6;
      text-shadow: 0 2px 16px #ffe3f7;
      letter-spacing: 0.1px;
      line-height: 1.5;
      word-break: break-word;
    }
    .btn {
      background: linear-gradient(90deg, #ffb7d9 0%, #b8f4ff 100%);
      border: none;
      border-radius: 22px;
      padding: 13px 36px;
      font-size: 1.08rem;
      font-family: inherit;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      margin: 8px 0px;
      margin-left: 6px;
      margin-right: 6px;
      box-shadow: 0 2px 14px 0 rgba(225, 77, 162, 0.10);
      transition: background 0.3s, transform 0.15s, box-shadow 0.2s;
      outline: none;
      position: relative;
      border: 2px solid #ffe3f7;
    }
    .btn:hover, .btn:focus {
      background: linear-gradient(90deg, #ff93c2 0%, #57c2e7 100%);
      transform: scale(1.08);
      box-shadow: 0 6px 18px rgba(225, 77, 162, 0.14);
    }
    .btn:active {
      transform: scale(1);
      box-shadow: 0 2px 14px rgba(225, 77, 162, 0.10);
    }

    .end-message {
      font-size: 1.18rem;
      font-weight: 500;
      color: #ff69b4;
      margin-top: 18px;
      margin-bottom: 12px;
      animation: fadeIn 1s;
    }
    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }

    @media (max-width: 500px) {
      .chat-container { padding: 22px 3vw 14px 3vw; max-width: 99vw; }
      .question { font-size: 1.05rem; min-height: 44px; }
      .sticker { font-size: 2.0rem; }
      .btn { font-size: 0.97rem; padding: 11px 16vw;}
      .music-btn { top: 8px; right: 12px; width: 39px; height: 39px; font-size: 1.25rem;}
    }
  </style>
</head>
<body>
  <!-- Nút phát/tắt nhạc -->
  <button class="music-btn" id="musicBtn" title="Bật/tắt nhạc"><span id="musicIcon">🎵</span></button>
  <!-- Audio nhạc -->
  <audio id="music" src="Anh Sai Rồi.mp3" preload="auto" loop></audio>
  <div class="chat-container">
    <div class="sticker" id="sticker">🥺</div>
    <div class="question" id="question"></div>
    <div id="answers"></div>
    <div class="end-message" id="end-message" style="display:none;"></div>
  </div>
  <script>
    // Nhạc
    const musicBtn = document.getElementById('musicBtn');
    const musicIcon = document.getElementById('musicIcon');
    const music = document.getElementById('music');
    let isPlaying = false;
    musicBtn.onclick = function() {
      if (isPlaying) {
        music.pause();
        musicIcon.textContent = "🎵";
        musicBtn.classList.remove('active');
      } else {
        music.play();
        musicIcon.textContent = "🔊";
        musicBtn.classList.add('active');
      }
      isPlaying = !isPlaying;
    };
    music.onended = function() {
      isPlaying = false;
      musicIcon.textContent = "🎵";
      musicBtn.classList.remove('active');
    };
    music.onpause = function() {
      isPlaying = false;
      musicIcon.textContent = "🎵";
      musicBtn.classList.remove('active');
    };
    music.onplay = function() {
      isPlaying = true;
      musicIcon.textContent = "🔊";
      musicBtn.classList.add('active');
    };

    // Tự động phát nhạc khi chạm vào màn hình (chỉ phát lần đầu)
    let musicAutoStarted = false;
    function startMusicOnTouch() {
      if (!musicAutoStarted) {
        music.play();
        isPlaying = true;
        musicIcon.textContent = "🔊";
        musicBtn.classList.add('active');
        musicAutoStarted = true;
      }
    }
    window.addEventListener('touchstart', startMusicOnTouch, {once:true});
    window.addEventListener('mousedown', startMusicOnTouch, {once:true});

    // Cấu trúc hỏi đáp
    const chatFlow = [
      {
        question: "Anh biết mình đã nhiều lần làm em khó chịu. Anh thật lòng xin lỗi em! 😔",
        sticker: "😓",
        answers: [
          { text: "Tôi cần phải suy nghĩ thêm", next: 1 },
          { text: "Đừng có mơ", next: 2 }
        ]
      },
      {
        question: "Anh thật sự rất trân trọng mối quan hệ này. Anh phải làm gì em mới chịu tha thứ cho anh?",
        sticker: "😭",
        answers: [
          { text: "Quỳ 3 ngày 3 đêm", next: 3 },
          { text: "Đi chết đi", next: 4 }
        ]
      },
      {
        question: "Anh đi chết đây T-T, tạm biệt em 😔",
        sticker: "😭",
        answers: [
          { text: "Kệ anh!", next: 4 },
          { text: "Tùy anh", next: 5 }
        ]
      },
      {
        question: "Đa tạ em rất nhiều!! Anh hứa sẽ thay đổi, anh đi quỳ đây! 💬",
        sticker: "🙏",
        answers: [
          { text: "Ukm!", next: 6 },
          { text: "Phải làm được mới tha!", next: 6 }
        ]
      },
      {
        question: "Em mà không tha thứ cho anh thì anh sẽ quỳ trước nhà em đến khi nào em tha thứ mới thôi 😔",
        sticker: "😭",
        answers: [
          { text: "Anh dám á, Cút!!!", next: 5 },
          { text: "Thôi! tốt nhất anh cứ liệu cái thần hồn. Lần này tạm tha ko có lần sau đâu nhé!", next: -1 }
        ]
      },
      {
        question: "Tha lỗi cho anh đi mà, xin em đấy, đi mà, đi mà năn nỉ đấy 😭!!",
        sticker: "🤧",
        answers: [
          { text: "Tôi cần phải suy nghĩ thêm", next: 1 },
          { text: "Không là không, anh có 3s để cút khỏi mắt tôi, cút!!", next: -1 }
        ]
      },
      {
        question: "Cảm ơn em đã tha thứ! Yêu em nhiều lắm! 💗",
        sticker: "😍",
        answers: [
          { text: "Kết thúc", next: -1 }
        ]
      }
    ];

    function typeWriter(text, element, i = 0, callback) {
      if (i < text.length) {
        element.innerHTML = text.substring(0, i+1);
        setTimeout(() => typeWriter(text, element, i+1, callback), 23);
      } else if (callback) {
        callback();
      }
    }

    function showStep(stepIndex) {
      if (stepIndex === -1) {
        document.getElementById("sticker").innerText = "🎉";
        document.getElementById("question").innerText = "";
        document.getElementById("answers").innerHTML = "";
        let endMsg = document.getElementById("end-message");
        endMsg.innerText = "Cuộc trò chuyện kết thúc! Cảm ơn em đã lắng nghe 💕";
        endMsg.style.display = "block";
        return;
      }
      const step = chatFlow[stepIndex];
      document.getElementById("sticker").innerText = step.sticker;
      let q = document.getElementById("question");
      let ans = document.getElementById("answers");
      document.getElementById("end-message").style.display = "none";
      ans.innerHTML = "";
      typeWriter(step.question, q, 0, () => {
        step.answers.forEach((answer, idx) => {
          const btn = document.createElement("button");
          btn.className = "btn";
          btn.innerText = answer.text;
          btn.onclick = () => showStep(answer.next);
          ans.appendChild(btn);
        });
      });
    }

    // Khởi động hiệu ứng hỏi đáp
    showStep(0);
  </script>
</body>
</html>